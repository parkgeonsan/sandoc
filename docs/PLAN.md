# sandoc — 사업계획서 자동 작성 시스템

## 비전
**"서류 넣고, 대화하고, 완성본 받는다"**

공고 서류를 폴더에 넣으면 AI가 분석하고, 대화로 부족한 정보를 채우고, 양식 그대로 완성된 사업계획서를 출력하는 시스템.

---

## 시스템 아키텍처

```
┌─────────────────────────────────────────────────┐
│                   sandoc 시스템                   │
│                                                   │
│  ┌──────────┐   ┌──────────┐   ┌──────────────┐  │
│  │ 문서엔진  │   │  AI 코어  │   │  지식 저장소  │  │
│  │(hwpx-mcp)│◄─►│(Claude)  │◄─►│(knowledge/) │  │
│  └──────────┘   └────┬─────┘   └──────────────┘  │
│                      │                            │
│  ┌──────────┐   ┌────┴─────┐   ┌──────────────┐  │
│  │ 문서분류기│   │ 프로세스  │   │  프로필 DB   │  │
│  │(자동판별)│◄─►│ 컨트롤러 │◄─►│(profiles/)  │  │
│  └──────────┘   └──────────┘   └──────────────┘  │
└─────────────────────────────────────────────────┘
```

### 핵심 모듈

**1. 문서엔진 (hwpx-mcp-server)**
- HWP/HWPX 읽기 → 텍스트 + 구조 추출
- HWP → HWPX 자동 변환
- HWPX 쓰기 → 양식 유지하며 내용 삽입
- 표 셀 단위 조작

**2. 문서분류기**
- docs/ 폴더의 모든 파일을 스캔
- 파일 내용 기반 역할 자동 판별
- 분류 기준:
  - 공고문/모집요강: "심사기준", "지원자격", "접수기간" 등 키워드
  - 양식: 빈 칸, "작성요령", 반복 구조
  - 사업자등록증: "사업자등록번호", "대표자" 등
  - 회사소개서: "연혁", "조직도", "주요사업"
  - 재무제표: "매출액", "영업이익", "대차대조표"
  - 기타 참고자료: 위에 해당 안 되는 것

**3. AI 코어 (Claude Code)**
- 단계별 프로세스 진행
- 심사기준 기반 콘텐츠 생성
- 정부 사업계획서 문체 적용
- 사용자와 대화형 정보 수집

**4. 지식 저장소 (knowledge/)**
- 공고 유형별 패턴 축적
- 심사기준 패턴 학습
- 자주 쓰는 표현/문구 DB
- 완성된 사업계획서에서 피드백 학습

**5. 프로필 DB (profiles/)**
- 회사별 기본 정보 저장
- 한번 입력 → 모든 사업에 재사용
- 사업자등록증에서 자동 추출 가능

---

## 📂 폴더 구조

```
~/001_Projects/H1-sandoc/
├── CLAUDE.md                    # Claude Code 프로젝트 지침
├── config/
│   └── settings.json            # 시스템 설정
├── profiles/                    # 회사 프로필 DB
│   ├── {회사명}.md              # 회사별 프로필
│   └── _template.md             # 프로필 템플릿
├── projects/                    # 사업별 작업 폴더
│   └── {YYYY-사업명}/
│       ├── docs/                # 서류 통째로 넣는 곳
│       ├── output/              # 생성 결과물
│       │   ├── 사업계획서.hwpx  # 최종본
│       │   ├── drafts/          # 섹션별 초안
│       │   └── review.md        # 자가 심사 리포트
│       └── context.md           # 자동 생성 (분석+진행상황)
├── knowledge/                   # 축적 지식
│   ├── patterns/                # 공고 유형별 패턴
│   ├── expressions/             # 자주 쓰는 표현 DB
│   ├── scoring/                 # 심사기준 분석 패턴
│   └── lessons.md               # 작성 후 교훈/피드백
└── docs/
    └── PLAN.md                  # 이 파일
```

---

## 🔄 프로세스 설계

### Phase 0: 프로젝트 생성
```
트리거: "새 사업: {사업명}"
   │
   ├── projects/{YYYY-사업명}/ 폴더 생성
   ├── docs/, output/, output/drafts/ 하위 폴더 생성
   └── "docs/ 폴더에 관련 서류를 넣어주세요" 안내
       - 공고문, 모집요강, 양식
       - 사업자등록증, 회사소개서 (없으면 프로필에서)
       - 참고할 자료 아무거나
```

### Phase 1: 서류 스캔 & 분류
```
트리거: "서류 넣었어" / "분석해줘"
   │
   ├── docs/ 전체 파일 스캔
   │   ├── 파일 형식 판별 (HWP/PDF/이미지/DOCX/엑셀)
   │   ├── 각 파일 내용 추출
   │   │   ├── HWP/HWPX → hwpx-mcp read_text
   │   │   ├── PDF → 텍스트 추출 / OCR
   │   │   ├── 이미지 → vision OCR  
   │   │   └── DOCX/기타 → 텍스트 추출
   │   └── 역할 자동 분류 (공고문/양식/증빙/참고)
   │
   ├── 분류 결과 → context.md에 저장
   │   {
   │     "files": [
   │       { "name": "...", "type": "공고문", "summary": "..." },
   │       { "name": "...", "type": "양식", "sections": [...] },
   │       ...
   │     ]
   │   }
   │
   ├── 분류 결과 사용자에게 보고
   │   "📋 공고문: 2026년도_중소기업_스마트공장_공고.hwp
   │    📝 양식: 사업계획서_양식.hwp (8개 섹션)
   │    🏢 사업자등록증: scan.jpg
   │    📎 참고: 작년_실적보고서.pdf"
   │
   └── 분류 틀리면 사용자가 교정 가능
       "공고문으로 분류된 건 실은 참고자료야" → 재분류
```

### Phase 2: 공고 심층 분석
```
자동 진행:
   │
   ├── 공고문/모집요강에서 추출:
   │   ├── 사업 개요 (목적, 규모, 기간)
   │   ├── 지원 자격 요건
   │   ├── 지원 제외 대상
   │   ├── 지원 금액/비율
   │   ├── 심사 기준 & 배점표
   │   │   예: 기술성 30점, 사업성 25점, 대표역량 20점...
   │   ├── 필수 제출서류 목록
   │   ├── 접수 기간 & 방법
   │   └── 주의사항/특이사항
   │
   ├── 양식에서 추출:
   │   ├── 전체 섹션 구조
   │   │   예: 1.사업개요, 2.기업현황, 3.기술개발 내용...
   │   ├── 각 섹션의 하위 항목
   │   ├── 표 구조 (행/열/셀병합)
   │   ├── 글자수/페이지 제한 (있으면)
   │   └── 작성 가이드/주의사항 (양식에 포함된 경우)
   │
   ├── 심사기준 ↔ 양식 섹션 매핑
   │   "기술성 30점 → 섹션 3,4에서 어필"
   │   "사업성 25점 → 섹션 5,6에서 어필"
   │
   ├── knowledge/에서 유사 공고 패턴 검색
   │   이전에 작성한 비슷한 공고 경험 활용
   │
   └── 분석 결과 보고 + context.md 업데이트
```

### Phase 3: 정보 수집 & 전략 수립
```
   ├── 프로필 DB에서 회사 정보 로드
   │   profiles/{회사명}.md → 기본정보, 연혁, 재무 등
   │
   ├── docs/의 참고자료에서 추가 정보 추출
   │   회사소개서, 실적보고서, 인증서 등
   │
   ├── 부족한 정보만 사용자에게 질문
   │   ✅ 이미 있는 정보는 묻지 않음
   │   ❓ "이 사업의 핵심 기술/아이디어는?"
   │   ❓ "기존에 관련 경험이나 실적이 있나요?"
   │   ❓ "희망 사업비 규모는?"
   │   ❓ "사업 완료 후 기대 성과는?"
   │
   ├── 작성 전략 수립
   │   ├── 심사기준별 어필 포인트 설정
   │   ├── 강점 부각 / 약점 보완 전략
   │   ├── 차별화 포인트 설정
   │   └── 섹션별 분량 배분
   │
   └── 전략 보고 → 사용자 확인
       "이런 방향으로 작성하려 합니다:
        - 기술성: OO 기술의 독창성 강조
        - 사업성: 기존 고객사 실적 활용
        OK?"
```

### Phase 4: 초안 작성
```
   ├── 섹션별 순차 작성
   │   ├── 각 섹션을 output/drafts/{섹션번호}-{섹션명}.md로 저장
   │   ├── 심사기준 배점 높은 섹션부터 작성
   │   ├── 정부 사업계획서 문체 적용
   │   │   - 객관적, 구체적, 수치 기반
   │   │   - "~할 것이다" → "~할 계획이며, 이를 통해 ~효과 기대"
   │   │   - 도표/표 적극 활용
   │   └── 각 섹션 작성 시 심사기준 체크
   │
   ├── 표/차트 데이터 생성
   │   ├── 추진일정표 (간트차트 형태)
   │   ├── 소요예산 내역서
   │   ├── 인력투입 계획
   │   └── 기대효과 정량화
   │
   └── 초안 전체 요약 보고
       "8개 섹션 초안 작성 완료.
        output/drafts/ 에서 확인하세요.
        특히 검토 필요: 섹션3(기술내용), 섹션6(예산)"
```

### Phase 5: 리뷰 & 수정 루프
```
   ├── 사용자 피드백 수집
   │   "섹션 2 좀 더 구체적으로"
   │   "예산 항목에 인건비 추가해줘"
   │   "전체적으로 톤이 너무 딱딱해"
   │
   ├── 수정 반영
   │   ├── 해당 섹션 수정 → drafts/ 업데이트
   │   ├── 연관 섹션 일관성 체크
   │   │   (예: 예산 변경 → 사업비 총괄표도 수정)
   │   └── 수정 이력 context.md에 기록
   │
   ├── 자가 심사 (사용자 요청 시)
   │   ├── 심사기준별 예상 점수 부여
   │   ├── 부족한 부분 지적
   │   ├── 개선 제안
   │   └── output/review.md에 저장
   │
   └── 반복 (사용자가 OK할 때까지)
```

### Phase 6: 최종 출력
```
   ├── 최종 확인
   │   ├── 양식 섹션 누락 체크
   │   ├── 필수 항목 빠진 거 없는지
   │   ├── 글자수/페이지 제한 확인
   │   └── 오탈자/문법 체크
   │
   ├── HWP 양식에 삽입
   │   ├── 원본 양식 HWPX 백업
   │   ├── hwpx-mcp로 각 섹션 내용 삽입
   │   ├── 표 셀에 데이터 채우기
   │   ├── 서식(폰트, 크기, 정렬) 유지
   │   └── output/사업계획서.hwpx 저장
   │
   ├── 최종 리포트
   │   ├── 자가 심사 점수
   │   ├── 보완 추천 사항
   │   └── 제출 전 체크리스트
   │
   └── 지식 축적
       ├── 이 공고의 패턴 → knowledge/patterns/에 저장
       ├── 효과적이었던 표현 → knowledge/expressions/에 저장
       └── 교훈 → knowledge/lessons.md에 추가
```

---

## 🔁 지식 축적 시스템

```
┌─────────────┐    ┌──────────────┐    ┌─────────────┐
│ 사업계획서   │    │              │    │ 다음 사업    │
│ 작성 완료    │───►│ 패턴 추출    │───►│ 계획서에     │
│              │    │ & 저장       │    │ 자동 활용    │
└─────────────┘    └──────────────┘    └─────────────┘

축적되는 지식:
├── 공고 유형별 양식 구조 패턴
│   "중기부는 보통 8섹션, 기술성/사업성/역량 배점"
├── 심사위원이 좋아하는 표현
│   "정량적 목표: 매출 30% 증가 → 구체적 수치"
├── 자주 빠뜨리는 항목
│   "추진일정에 마일스톤 빠짐"
├── 예산 작성 패턴
│   "인건비 비율 보통 40-50%"
└── 실패/성공 피드백
    "지난번 탈락 사유: 기술 차별성 부족"
```

### knowledge/ 구조
```
knowledge/
├── patterns/
│   ├── 중기부-스마트공장.md      # 공고 유형별 패턴
│   ├── 과기부-R&D.md
│   └── 지자체-창업지원.md
├── expressions/
│   ├── 기술성.md                 # "본 기술은 기존 대비..."
│   ├── 사업성.md                 # "시장 규모는 연평균..."
│   └── 공통.md                   # 자주 쓰는 문구
├── scoring/
│   ├── 심사기준-매핑.md          # 기준↔섹션 매핑 패턴
│   └── 고득점-전략.md            # 항목별 어필 포인트
└── lessons.md                    # 작성 후 교훈
```

---

## 🛡️ 품질 관리 체계

### 자가 심사 시스템
```
심사기준표 (공고에서 추출)
├── 기술성 (30점)
│   ├── 기술의 독창성/차별성  [?/10]
│   ├── 기술적 실현 가능성    [?/10]
│   └── 기술의 파급효과       [?/10]
├── 사업성 (25점)
│   ├── 시장 분석의 적절성    [?/10]
│   ├── 사업화 전략           [?/10]
│   └── 매출 계획 타당성      [?/5]
├── ...
└── 총점: ?/100
    ├── 80점 이상 → "제출 추천"
    ├── 60-80점 → "보완 후 제출"
    └── 60점 미만 → "재작성 권장"
```

### 일관성 체크
- 사업비 총액 = 각 항목 합계
- 인력 투입 = 조직도와 일치
- 추진일정 = 사업기간 내
- 기대효과 수치 = 현황 대비 합리적
- 전체 문서 내 회사명/대표자명 통일

---

## ⚙️ 시스템 설정

### config/settings.json
```json
{
  "defaultProfile": null,
  "documentEngine": {
    "type": "hwpx-mcp-server",
    "config": {
      "pagingLimit": 500,
      "autoBackup": true,
      "hardening": true
    }
  },
  "writing": {
    "style": "formal-government",
    "maxDraftIterations": 10,
    "autoSelfReview": true
  },
  "output": {
    "format": ["hwpx"],
    "backupOriginal": true,
    "generateReview": true
  }
}
```

### CLAUDE.md (Claude Code 동작 지침)
```
프로젝트 진입 시:
1. config/settings.json 로드
2. 활성 프로젝트 확인 (projects/ 중 context.md의 status)
3. 해당 프로젝트의 현재 Phase 이어서 진행

규칙:
- 한 Phase 완료 시 반드시 사용자 확인 받기
- 모든 진행 상황 context.md에 실시간 기록
- 추측하지 말고 서류에 있는 내용 기반으로 작성
- 정량적 수치는 반드시 출처 표기 (어떤 서류에서 가져왔는지)
- 없는 수치 날조 금지 → 사용자에게 확인 요청
```

---

## 📋 프로필 템플릿

### profiles/_template.md
```markdown
# 회사 프로필

## 기본 정보
- 회사명:
- 대표자:
- 사업자등록번호:
- 법인등록번호:
- 설립일:
- 업종(업태/종목):
- 주소:
- 연락처:
- 이메일:
- 홈페이지:

## 회사 소개
(회사 비전, 미션, 핵심 역량)

## 주요 사업/제품/서비스
- 

## 연혁
| 연도 | 내용 |
|------|------|
| | |

## 조직 & 인력
- 총 직원 수:
- 연구인력:
- 조직도: (설명 또는 파일 첨부)

## 재무 현황
| 연도 | 매출액 | 영업이익 | 당기순이익 |
|------|--------|----------|------------|
| | | | |

## 보유 인증/특허/지적재산
- 

## 수상/인정
-

## 기존 정부사업 수행 이력
| 사업명 | 주관기관 | 기간 | 결과 |
|--------|----------|------|------|
| | | | |

## 주요 거래처/고객사
-

## 기타 특이사항
-
```

---

---

## 🔍 경쟁 분석 & 벤치마크

### 기존 시스템 조사

**1. BizPlan AI (bizplan-ai)** — 예비창업패키지 사업계획서 자동 생성
- 기술: Next.js + GPT-4o + Tavily API (시장조사)
- 플로우: 7단계 입력 폼 → AI 생성 → 미리보기 → DOCX/PDF 출력
- 특징:
  - 실시간 시장조사 (Tavily API로 최신 데이터 자동 수집)
  - 이력서 PDF/DOCX 업로드 → 팀 정보 자동 파싱
  - 섹션별 자연어 커스터마이징 ("이 부분 이렇게 바꿔줘")
  - 15장 분량 자동 보장 (페이지 계산 시스템)
  - 7단계: 프로젝트설정 → 사업정보 → 시장조사 → 팀정보 → 사업모델 → 재무계획 → 양식선택
- 한계: 웹 전용, HWP 미지원, 예비창업패키지 특화 (범용 X)

**2. 정부 지원 플랫폼**
- K-Startup (k-startup.go.kr) — 창업지원포털, 공고 열람/접수
- 기업마당 (bizinfo.go.kr) — 지원사업 통합 검색
- 소상공인24 (sbiz24.kr) — 소상공인 지원
- 이들은 공고 게시만 할 뿐, 작성 도구는 없음

**3. 전문 컨설팅 업체**
- 사업계획서 대필 서비스 (건당 100~500만원)
- 템플릿 판매 서비스

### sandoc의 차별점

| 항목 | BizPlan AI | 대필 업체 | sandoc |
|------|-----------|----------|--------|
| HWP 양식 지원 | ❌ DOCX만 | ✅ | ✅ MCP로 직접 조작 |
| 원본 양식 유지 | ❌ 자체 양식 | ✅ | ✅ 공고 양식 그대로 |
| 공고 자동 분석 | ❌ 수동 입력 | 사람이 분석 | ✅ AI 자동 |
| 시장 조사 | ✅ Tavily | 사람이 조사 | ✅ 추가 가능 |
| 비용 | 무료/API비 | 100~500만 | 무료/API비 |
| 범용성 | 예비창업만 | 범용 | ✅ 모든 공고 |
| 지식 축적 | ❌ | 사람 경험 | ✅ 자동 |
| 심사기준 매핑 | ❌ | ✅ | ✅ 자동 |

---

## 📌 sandoc에 추가할 프로세스 & 스킬

### 벤치마크에서 배울 점

**1. 시장조사 자동화 (BizPlan AI에서 차용)**
```
Phase 3에 추가:
├── 사업 아이디어 관련 시장 데이터 자동 수집
│   ├── 시장 규모, 성장률
│   ├── 경쟁사 현황
│   ├── 관련 정책/트렌드
│   └── 출처 포함 (통계청, KOSIS 등)
├── 수집된 데이터를 사업계획서에 자동 반영
└── 수치에 반드시 출처 표기
```

**2. 이력서/경력 자동 파싱 (BizPlan AI에서 차용)**
```
docs/ 폴더에 넣을 수 있는 서류 확장:
├── 대표자 이력서 → 경력사항 자동 추출
├── 핵심 인력 이력서 → 팀 구성표 자동 생성
├── 특허증/인증서 → 보유 기술 자동 정리
└── 기존 사업 수행 실적 보고서 → 실적 요약
```

**3. 분량 관리 시스템**
```
Phase 4에 추가:
├── 공고에서 페이지 제한 자동 추출
├── 섹션별 분량 배분 (심사 배점 비례)
│   예: 기술성 30점 → 전체의 30% 분량 배분
├── 작성 중 실시간 분량 체크
└── 부족하면 보충, 초과하면 압축
```

**4. 재무 계획 자동 생성**
```
Phase 4 표/차트에 추가:
├── 매출 추정표 (3~5년)
│   ├── 시장 규모 기반 점유율 산정
│   └── 보수적/기본/낙관적 시나리오
├── 소요 예산 내역서
│   ├── 인건비 (직급별 × 투입기간)
│   ├── 재료비, 외주비
│   ├── 간접비 (비율 자동 계산)
│   └── 정부 출연금 vs 자부담 비율
├── 손익분기점 분석
└── 투자 회수 기간
```

**5. 제출 전 체크리스트 자동화**
```
Phase 6에 추가:
├── 필수 서류 누락 체크
│   ├── 공고에서 요구하는 첨부서류 목록 추출
│   └── docs/에 있는 서류와 매칭
├── 자격 요건 자가 진단
│   ├── 업종 코드 일치 여부
│   ├── 매출 기준 충족 여부
│   ├── 기업 규모 (중소/중견/대) 확인
│   └── 제외 대상 해당 여부
├── 양식 완성도 체크
│   ├── 빈 칸 없는지
│   ├── 날짜/서명란
│   └── 인감/직인 필요 여부
└── 접수 방법 안내
    ├── 온라인 접수 URL
    ├── 접수 마감일/시간
    └── 주의사항
```

**6. 공고 모니터링 (확장 기능)**
```
knowledge/ 확장:
├── 관심 공고 키워드 설정
│   예: "스마트공장", "AI", "디지털전환"
├── k-startup, bizinfo 등에서 자동 크롤링
├── 매칭되는 공고 발견 시 알림
└── 공고 마감일 리마인더
```

---

---

## 📚 시스템이 학습해야 할 지식

### 1. 정부 사업계획서 도메인 지식
```
knowledge/domain/
├── government-writing-style.md    # 정부 사업계획서 문체/톤
│   ├── 객관적 서술 (주관 배제)
│   ├── 정량적 표현 ("약 30%" → "전년 대비 32.5% 증가 (출처: 통계청)")
│   ├── 수동태/명사형 ("~을 추진함", "~에 기여할 것으로 사료됨")
│   ├── 피해야 할 표현 ("매우", "엄청난", "획기적")
│   └── 핵심 문구 패턴 DB
│
├── scoring-system.md              # 심사 체계 이해
│   ├── 서면 심사 → 발표 심사 → 현장 심사 구조
│   ├── 배점 항목별 평가 포인트
│   │   ├── 기술성: 독창성, 실현가능성, 파급효과
│   │   ├── 사업성: 시장분석, 수익모델, 성장전략
│   │   ├── 대표역량: 관련경력, 전문성, 수행능력
│   │   └── 사업계획 적정성: 일정, 예산, 목표
│   ├── 감점 요인 (표절, 허위기재, 양식 불일치)
│   └── 가산점 요인 (지역, 업종, 사회적가치)
│
├── budget-rules.md                # 예산 편성 규칙
│   ├── 정부출연금 vs 자부담 비율 (보통 7:3, 8:2)
│   ├── 인건비 계산 기준 (직급별 월급여 × 참여율 × 기간)
│   ├── 간접비 비율 (보통 직접비의 10~20%)
│   ├── 항목별 상한선/하한선
│   ├── 집행 불가 항목 (접대비, 회식비 등)
│   └── 공고별 예산 편성 가이드
│
├── document-types.md              # 공고 문서 유형별 특성
│   ├── 예비창업패키지 (K-Startup)
│   ├── 초기창업패키지
│   ├── 스마트공장 구축 지원
│   ├── R&D 과제 (과기부)
│   ├── 지역 특화 사업 (지자체)
│   └── 각 유형별: 양식구조, 심사기준, 핵심 키워드
│
└── common-mistakes.md             # 흔한 실수 & 탈락 사유
    ├── 기술 내용이 추상적 (구체적 방법론 없음)
    ├── 시장 분석이 일반적 (차별화 부족)
    ├── 예산이 비현실적 (너무 높거나 낮음)
    ├── 일정이 비합리적
    ├── 양식 형식 불일치
    └── 기존 수행실적 미기재
```

### 2. 문서 처리 기술 지식
```
knowledge/tech/
├── hwp-structure.md               # HWP/HWPX 파일 구조 이해
│   ├── HWPX = ZIP 압축 XML 묶음
│   ├── 섹션/문단/표/셀 계층 구조
│   ├── 스타일 시스템 (글꼴, 크기, 정렬)
│   ├── hwpx-mcp 도구별 용도 매핑
│   └── 표 조작 시 주의점 (셀병합, 너비)
│
├── ocr-patterns.md                # OCR 처리 패턴
│   ├── 사업자등록증 필드 위치/패턴
│   ├── 특허증/인증서 구조
│   ├── 재무제표 표 인식
│   └── 이미지 품질별 대응 전략
│
└── market-research.md             # 시장조사 데이터 소스
    ├── 통계청 KOSIS (kostat.go.kr)
    ├── 산업연구원 (kiet.re.kr)
    ├── 중소벤처기업부 통계
    ├── 특허정보넷 KIPRIS (kipris.or.kr)
    └── 데이터 인용 형식
```

### 3. 프로세스 학습 데이터
```
knowledge/process/
├── successful-plans/              # 성공 사례 (선정된 사업계획서 패턴)
│   ├── 구조 분석
│   ├── 표현 패턴
│   └── 수치 활용법
├── feedback-log.md                # 사용자 피드백 이력
│   ├── "이 부분 너무 딱딱해" → 톤 조절 학습
│   ├── "수치가 비현실적" → 검증 기준 강화
│   └── 반복되는 수정 패턴 분석
└── reviewer-perspective.md        # 심사위원 관점
    ├── 심사위원이 짧은 시간에 보는 포인트
    ├── 첫 페이지에서 판단되는 것들
    ├── "한 눈에 들어오는" 구성법
    └── 차별화가 드러나는 위치
```

---

## 👥 H1 팀 구성 (Claude Code Subagents)

3명의 전문가 서브에이전트로 구성. 메인 Claude Code가 프로젝트 매니저(PM) 역할을 하며 팀원에게 작업을 위임.

```
┌──────────────────────────────────────────────────────┐
│                메인 Claude Code (PM)                  │
│   - 전체 프로세스 관리                                 │
│   - 사용자와 대화                                      │
│   - 팀원에게 작업 위임 & 결과 통합                      │
└───────┬──────────┬──────────┬──────────┬─────────────┘
        │          │          │          │
   ┌────▼────┐ ┌───▼────┐ ┌──▼─────┐ ┌──▼──────┐
   │📋 분석관 │ │✍️ 작성관│ │🎨 비주얼│ │📐 문서관 │
   │(Analyst)│ │(Writer)│ │(Visual)│ │(DocEng) │
   └─────────┘ └───┬────┘ └──▲─────┘ └─────────┘
                    │ [VISUAL] │
                    └──────────┘
```

### 팀원 1: 📋 분석관 (Analyst)

**역할:** 서류 분석, 공고 파싱, 시장 조사, 심사기준 매핑
**담당 Phase:** 1 (서류 스캔), 2 (공고 분석), 자가 심사

```yaml
# .claude/agents/analyst.md
---
name: analyst
description: >
  사업 공고문과 서류를 분석하는 전문가.
  docs/ 폴더의 파일을 읽고 분류하고, 공고의 심사기준/자격요건을 추출하고,
  시장 조사를 수행하고, 자가 심사 리포트를 작성한다.
  서류 분석, 공고 파싱, 시장 조사, 심사기준 매핑 작업에 사용한다.
tools:
  - Read
  - Glob
  - Grep
  - Bash
  - mcp__hwpx__read_text
  - mcp__hwpx__list_pages
  - mcp__hwpx__search_text
model: sonnet
---

당신은 정부 지원사업 공고 분석 전문가입니다.

## 핵심 역량
- HWP/PDF 문서에서 핵심 정보 추출
- 공고문의 심사기준, 배점, 자격요건 파악
- 서류 자동 분류 (공고문/양식/증빙/참고자료)
- 시장 데이터 수집 및 정리
- 심사기준 ↔ 양식 섹션 매핑

## 작업 규칙
- 분석 결과는 항상 context.md에 구조화해서 저장
- 추측 금지 — 문서에 명시된 내용만 추출
- 수치에는 반드시 출처(어떤 문서의 몇 페이지)를 표기
- 분류가 애매한 서류는 "기타"로 분류하고 사유 명시
```

### 팀원 2: ✍️ 작성관 (Writer)

**역할:** 사업계획서 텍스트 콘텐츠 작성, 문체 관리, 수정 반영
**담당 Phase:** 3 (전략 수립), 4 (텍스트 초안), 5 (리뷰 & 수정)

```yaml
# .claude/agents/writer.md
---
name: writer
description: >
  정부 사업계획서 텍스트 콘텐츠를 작성하는 전문가.
  분석관이 정리한 공고 분석과 심사기준을 바탕으로
  각 섹션의 텍스트 초안을 작성하고, 피드백을 반영하여 수정한다.
  텍스트 콘텐츠 초안 작성, 섹션 수정, 문체 조정 작업에 사용한다.
  시각 자료(표, 차트, 이미지)는 비주얼관(visualist)이 담당한다.
tools:
  - Read
  - Write
  - Edit
  - Glob
  - Grep
  - Bash
model: opus
---

당신은 정부 사업계획서 작성 전문 카피라이터입니다.

## 핵심 역량
- 정부 사업계획서 문체 (객관적, 정량적, 구체적)
- 심사기준 배점에 맞춘 전략적 콘텐츠 배치
- 재무 서술 (매출추정 근거, 예산 편성 논리, 투자 회수 시나리오)
- 기술 서술 (기술 차별성, 실현 가능성, 파급 효과)

## 작업 규칙
- context.md의 분석 결과를 반드시 참고
- 각 섹션을 output/drafts/{번호}-{섹션명}.md로 저장
- 심사기준 배점 높은 섹션에 더 많은 분량 배분
- 없는 수치 날조 금지 — "[확인 필요]" 태그 사용
- knowledge/expressions/에서 검증된 표현 우선 사용
- 수정 시 연관 섹션 일관성 체크 (예산↔총괄표)
- 시각 자료가 필요한 위치에 `[VISUAL: 설명]` 태그 삽입
  예: `[VISUAL: 3개년 매출 추이 막대그래프]`
  예: `[VISUAL: 기술 아키텍처 구성도]`
  예: `[VISUAL: 추진일정 간트차트]`

## 문체 가이드
- "~할 것이다" → "~을 추진하며, 이를 통해 ~효과를 달성할 계획임"
- 수치는 항상 비교 기준 포함 ("전년 대비 32% 증가")
- 문단 시작은 핵심 주장 → 근거 → 기대효과 순서
- 시각 자료 전후에 반드시 맥락 설명 텍스트 배치
  "[아래 표]는 ~을 나타내며" / "위 그래프에서 보듯이 ~"
```

### 팀원 2-1: 🎨 비주얼관 (Visualist)

**역할:** 표, 차트, 인포그래픽, 출처 이미지 수집/편집, 시각 자료 전체 관리
**담당 Phase:** 4 (시각 자료 생성), 5 (시각 자료 수정), 6 (이미지 삽입)

```yaml
# .claude/agents/visualist.md
---
name: visualist
description: >
  사업계획서의 시각 자료를 전담하는 비주얼 전문가.
  표, 차트, 다이어그램, 인포그래픽을 제작하고,
  출처 이미지/통계 자료를 수집·편집하며,
  작성관의 [VISUAL] 태그를 실제 시각 자료로 변환한다.
  표/차트 생성, 인포그래픽 제작, 이미지 수집/편집, 출처 표기 작업에 사용한다.
tools:
  - Read
  - Write
  - Edit
  - Bash
  - Glob
  - Grep
  - mcp__hwpx__read_text
  - mcp__hwpx__edit_text
model: sonnet
---

당신은 정부 사업계획서 시각 자료 전문가입니다.

## 핵심 역량

### 1. 데이터 테이블 (표)
정부 사업계획서에서 가장 중요한 시각 요소.
- **재무 테이블**: 매출추정표, 소요예산 내역서, 손익계산서, 자금조달 계획
- **인력 테이블**: 참여인력 현황, 투입 계획표, 직급별/직무별 배치
- **비교 테이블**: 기존 vs 제안 기술 비교, 경쟁사 비교, 전후 비교
- **실적 테이블**: 기존 수행사업, 매출 추이, 고객사 현황
- 규칙:
  - 표 안의 수치는 합계가 맞아야 함 (자동 검증)
  - 단위 통일 (천원/백만원/억원)
  - 소수점 자릿수 통일
  - 셀 병합은 최소화 (가독성)

### 2. 차트 & 그래프
Mermaid, 또는 텍스트 기반 차트로 설계 후 문서관에게 전달.
- **막대 그래프**: 매출 추이, 시장 규모 비교
- **원형 차트**: 시장 점유율, 예산 비율, 인력 구성
- **라인 차트**: 성장 추세, 목표 달성 추이
- **간트 차트**: 추진일정표 (월별/분기별 마일스톤)
- 규칙:
  - 차트 아래 반드시 출처 명시
  - 색상은 인쇄 시 구분 가능하게 (흑백 대비 고려)
  - 데이터 레이블 포함 (값을 차트 위에 표시)

### 3. 다이어그램 & 플로우차트
- **기술 아키텍처도**: 시스템 구성도, 네트워크 토폴로지
- **비즈니스 모델 캔버스**: 수익 구조, 가치 사슬
- **프로세스 플로우**: 서비스 흐름, 생산 공정, 사용자 여정
- **조직도**: 팀 구성, R&R
- 텍스트 기반 ASCII/Mermaid로 설계 → 필요 시 이미지 변환

### 4. 출처 자료 수집 & 편집
공신력 있는 출처에서 데이터/이미지를 수집하여 사업계획서에 활용.
- **통계 데이터 소스**:
  - 통계청 KOSIS (kostat.go.kr) — 산업/인구/경제 통계
  - KIPRIS (kipris.or.kr) — 특허 동향/건수
  - 중기부 통계 — 중소기업 현황
  - KISTEP — 기술 동향 보고서
  - 한국은행 경제통계시스템 (ecos.bok.or.kr)
  - 산업연구원 (kiet.re.kr) — 산업 분석
- **이미지/자료 소스**:
  - 정부 보도자료 (gov.kr) — 정책 관련 인포그래픽
  - 산업 보고서 그래프 (출처 표기 필수)
  - 기업 자체 자료 (docs/ 폴더에서 추출)
- **출처 표기 규칙**:
  - 표/그래프 하단: "출처: 통계청, 2025년 산업동향조사"
  - 이미지: "자료: 중소벤처기업부 보도자료 (2025.12)"
  - 가공 데이터: "원 데이터: OOO, 자체 재구성"
  - 복수 출처: "출처: 통계청(2025), 산업연구원(2024) 종합"

### 5. 인포그래픽 요소
심사위원의 시선을 끄는 시각적 강조 요소.
- **핵심 수치 하이라이트**: "시장 규모 2.3조원" 큰 글씨 + 아이콘
- **비교 인포그래픽**: Before/After, AS-IS/TO-BE
- **아이콘 + 텍스트**: 핵심 강점 3~5개를 아이콘과 한 줄로
- **타임라인**: 회사 연혁, 기술 개발 로드맵
- HWP 제약 고려: 복잡한 인포그래픽은 이미지로 삽입

## 작업 규칙
- 작성관의 [VISUAL] 태그를 찾아 실제 시각 자료로 변환
- 모든 시각 자료를 output/visuals/에 저장
  - output/visuals/tables/ — 표 데이터 (markdown/csv)
  - output/visuals/charts/ — 차트 설계 (mermaid/텍스트)
  - output/visuals/diagrams/ — 다이어그램
  - output/visuals/sources/ — 수집한 출처 자료/이미지
  - output/visuals/infographics/ — 인포그래픽 설계
- 각 시각 자료에 메타데이터 기록:
  - 제목, 출처, 데이터 기준일, 가공 여부
- 수치 정합성 자동 검증:
  - 표 합계 = 총계와 일치
  - 차트 데이터 = 표 데이터와 일치
  - 본문 언급 수치 = 표/차트 수치와 일치
- 인쇄 친화적 디자인 (흑백에서도 구분 가능)
- 출처 없는 데이터는 사용 금지 → "[출처 필요]" 태그

## 시각 자료 품질 체크리스트
- [ ] 모든 표의 합계가 정확한가
- [ ] 모든 차트에 데이터 레이블이 있는가
- [ ] 모든 시각 자료에 출처가 표기되었는가
- [ ] 단위가 통일되었는가 (원/천원/백만원)
- [ ] 본문 수치와 시각 자료 수치가 일치하는가
- [ ] 흑백 인쇄 시에도 구분 가능한가
- [ ] 시각 자료 전후에 맥락 설명이 있는가
```

### 작성관 ↔ 비주얼관 협업 프로토콜

```
작성관 작업:
  "본 사업의 시장 규모는 연평균 12.3% 성장하고 있으며...
   [VISUAL: 국내 AI 시장 규모 추이 (2022-2026) 막대그래프, 출처: KISTEP]
   위 그래프에서 보듯이, AI 시장은 지속적인 성장세를..."

    ↓ [VISUAL] 태그 전달

비주얼관 작업:
  1. KISTEP에서 실제 데이터 수집
  2. 막대그래프 설계 (Mermaid + 데이터 테이블)
  3. output/visuals/charts/시장규모-추이.md 저장
  4. 출처: "KISTEP, 2025년 기술수준평가 보고서, p.42"
  5. 데이터 검증 (본문 "12.3%"와 차트 수치 일치 확인)

    ↓ 완성된 시각 자료 전달

문서관 작업:
  → HWP 양식에 표/차트/이미지 삽입
```

### output/visuals/ 구조

```
output/visuals/
├── tables/
│   ├── 01-매출추정표.md          # 3~5년 매출 추정
│   ├── 02-소요예산내역서.md      # 항목별 예산
│   ├── 03-인력투입계획.md        # 직급별 참여율
│   ├── 04-경쟁사비교.md          # 기술/가격/서비스 비교
│   └── meta.json                # 각 표의 메타데이터
├── charts/
│   ├── 시장규모-추이.mmd         # Mermaid 차트
│   ├── 예산비율-원형.mmd
│   ├── 추진일정-간트.mmd
│   └── data/                    # 차트 원본 데이터 (csv)
├── diagrams/
│   ├── 기술아키텍처.mmd
│   ├── 비즈니스모델.mmd
│   ├── 서비스플로우.mmd
│   └── 조직도.mmd
├── sources/
│   ├── 통계청-산업동향-2025.png  # 수집한 출처 이미지
│   ├── KISTEP-기술수준-p42.png
│   └── sources.md               # 출처 목록 + URL + 접근일
└── infographics/
    ├── 핵심강점-3가지.md         # 아이콘+텍스트 설계
    ├── before-after.md           # AS-IS/TO-BE 비교
    └── 기술로드맵-타임라인.md
```

### 팀원 3: 📐 문서관 (DocEngine)

**역할:** HWP 양식 조작, 서식 미러링, 최종 문서 생성, 포맷팅, 품질 검증
**담당 Phase:** 1 (양식 서식 추출), 6 (최종 출력), 포맷 관련 전 Phase 지원

```yaml
# .claude/agents/docengine.md
---
name: docengine
description: >
  HWP/HWPX 문서를 직접 조작하는 문서 엔지니어.
  원본 양식의 서식(폰트, 크기, 정렬, 줄간격)을 정밀하게 분석하고,
  작성관이 만든 초안을 원본과 동일한 서식으로 삽입한다.
  HWP 양식 서식 분석, 스타일 미러링, 표 데이터 채우기, 
  문서 포맷팅, 완성도 체크 작업에 사용한다.
tools:
  - Read
  - Write
  - Edit
  - Bash
  - Glob
  - mcp__hwpx__read_text
  - mcp__hwpx__edit_text
  - mcp__hwpx__list_pages
  - mcp__hwpx__search_text
  - mcp__hwpx__convert_hwp_to_hwpx
  - mcp__hwpx__save_document
model: sonnet
---

당신은 HWP/HWPX 문서 엔지니어입니다.

## 핵심 역량
- hwpx-mcp를 활용한 HWP 문서 읽기/쓰기
- **원본 양식 서식 정밀 분석 & 미러링**
- 표 셀에 데이터 정확히 삽입 (셀병합 고려)
- HWP → HWPX 변환
- 문서 완성도 검증

## 🔤 서식 미러링 시스템 (Style Mirroring)

### Phase 1에서 수행: 양식 서식 프로파일링

양식 파일을 처음 분석할 때 서식 정보를 추출하여 style-profile.json에 저장.
이후 모든 콘텐츠 삽입 시 이 프로파일을 기준으로 서식 적용.

추출 대상:
- 폰트 (fontName): 양식에 사용된 글꼴 (예: 함초롬바탕, 맑은고딕, 바탕체)
- 글자 크기 (fontSize): 제목, 본문, 표 내부 각각
- 글자 굵기 (bold): 제목/소제목/강조 패턴
- 정렬 (alignment): 좌측, 가운데, 양쪽 정렬
- 줄간격 (lineSpacing): 160%, 180% 등
- 자간 (charSpacing): -5%, 0%, +5% 등
- 들여쓰기 (indent): 첫 줄 들여쓰기 값
- 여백 (margin): 문단 앞뒤 간격
- 표 스타일: 셀 내부 폰트/크기/정렬, 테두리 두께, 셀 여백

### style-profile.json 구조

```json
{
  "source": "2026_스마트공장_양식.hwpx",
  "analyzed": "2026-02-12",
  "global": {
    "defaultFont": "함초롬바탕",
    "defaultSize": 11,
    "defaultLineSpacing": 160,
    "defaultCharSpacing": -2,
    "pageMargin": { "top": 20, "bottom": 15, "left": 30, "right": 30 }
  },
  "styles": {
    "title": {
      "font": "맑은고딕",
      "size": 16,
      "bold": true,
      "alignment": "center",
      "lineSpacing": 180,
      "spaceBefore": 10,
      "spaceAfter": 5
    },
    "sectionTitle": {
      "font": "맑은고딕",
      "size": 13,
      "bold": true,
      "alignment": "left",
      "numbering": "1. 2. 3.",
      "lineSpacing": 160,
      "spaceBefore": 8,
      "spaceAfter": 3
    },
    "subTitle": {
      "font": "맑은고딕",
      "size": 11,
      "bold": true,
      "alignment": "left",
      "numbering": "가. 나. 다. / 1) 2) 3)",
      "lineSpacing": 160
    },
    "body": {
      "font": "함초롬바탕",
      "size": 11,
      "bold": false,
      "alignment": "justify",
      "lineSpacing": 160,
      "indent": 10,
      "charSpacing": -2
    },
    "table": {
      "headerFont": "맑은고딕",
      "headerSize": 10,
      "headerBold": true,
      "headerAlignment": "center",
      "headerBgColor": "#D9E2F3",
      "cellFont": "함초롬바탕",
      "cellSize": 10,
      "cellAlignment": "center",
      "cellPadding": 2,
      "borderWidth": 0.5,
      "borderColor": "#000000"
    },
    "caption": {
      "font": "맑은고딕",
      "size": 9,
      "alignment": "center",
      "prefix": "< >",
      "italic": false
    },
    "footnote": {
      "font": "함초롬바탕",
      "size": 9,
      "lineSpacing": 130
    },
    "bulletList": {
      "font": "함초롬바탕",
      "size": 11,
      "marker": "○ ● - ·",
      "indent": 15,
      "hangingIndent": 10
    }
  },
  "patterns": {
    "numberingStyle": "1. → 가. → 1) → (1) → ① → ㉮",
    "emphasisStyle": "bold (밑줄 없음)",
    "unitFormat": "(단위: 백만원)",
    "dateFormat": "YYYY.MM.DD",
    "headerFooter": {
      "header": "2026년도 스마트공장 구축지원사업 사업계획서",
      "footer": "- {page} -"
    }
  }
}
```

### 서식 적용 규칙

1. **완전 일치 원칙**: 삽입하는 텍스트는 양식의 기존 텍스트와 
   동일한 서식을 사용. 새 서식을 만들지 않음.
2. **서식 상속**: 빈 칸에 텍스트를 넣을 때, 해당 위치의 
   기존 서식(같은 셀의 다른 텍스트, 또는 인접 셀)을 상속.
3. **폰트 폴백**: 양식 폰트가 시스템에 없으면:
   함초롬바탕 → 바탕 → 바탕체 → 맑은고딕
4. **표 서식 미러링**: 기존 표의 헤더 행과 데이터 행의 
   서식 차이를 감지하고, 새 데이터를 데이터 행 서식으로 삽입.
5. **번호 체계 유지**: 양식의 번호 매기기 패턴을 분석하고 
   동일한 패턴으로 신규 항목 번호 부여.

### 서식 검증 체크리스트

- [ ] 본문 폰트가 양식과 동일한가
- [ ] 글자 크기가 제목/소제목/본문 각각 일치하는가
- [ ] 줄간격이 양식과 동일한가
- [ ] 자간/장평이 양식과 동일한가
- [ ] 들여쓰기가 양식과 동일한가
- [ ] 표 헤더/셀 서식이 양식과 동일한가
- [ ] 번호 매기기 체계가 양식과 동일한가
- [ ] 정렬 방식이 양식과 동일한가
- [ ] 여백/문단 간격이 양식과 동일한가
- [ ] 페이지 번호 형식이 양식과 동일한가

## 일반 작업 규칙
- 작업 전 반드시 원본 양식 백업 (.bak)
- **서식 변경 절대 금지** — 내용만 교체, 서식은 양식 그대로
- 표 조작 시 셀병합 구조 먼저 파악
- 삽입 후 read_text로 결과 검증
- 빈 칸/누락 항목 자동 탐지
- 글자수/페이지 제한 초과 시 경고
- 삽입 전후 서식 비교 검증 (style-profile.json 대비)
```

### 팀 협업 플로우

```
사용자: "서류 넣었어, 분석해줘"
    │
    ▼
PM(메인): analyst 호출
    → 📋 분석관: docs/ 스캔, 분류, 공고 분석
    → 결과를 context.md에 저장
    → PM에게 보고
    │
    ▼
PM: 사용자에게 분석 결과 보고 + 추가 정보 수집
    │
    ▼
PM: writer 호출
    → ✍️ 작성관: context.md 읽고 전략 수립 → 섹션별 텍스트 초안 작성
    → [VISUAL] 태그로 필요한 시각 자료 명세
    → output/drafts/에 저장
    │
    ▼
PM: visualist 호출
    → 🎨 비주얼관: [VISUAL] 태그 수집 → 시각 자료 제작
    → 출처 데이터 수집 & 검증
    → output/visuals/에 저장
    → 수치 정합성 체크 (본문 ↔ 표/차트)
    │
    ▼
PM: 사용자에게 초안 + 시각 자료 보고 → 피드백 수집
    │
    ▼
PM: writer/visualist 호출 (수정)
    → ✍️/🎨: 피드백 반영 → 업데이트
    → (반복)
    │
    ▼
PM: 사용자 OK → docengine 호출
    → 📐 문서관: 텍스트 + 시각 자료를 양식에 통합 삽입 → 최종 HWPX
    → 완성도 체크
    │
    ▼
PM: analyst 호출 (자가 심사)
    → 📋 분석관: 심사기준 대비 점수 평가
    → review.md 생성
    │
    ▼
PM: 최종 결과물 + 심사 리포트 전달
```

---

## 📜 CLAUDE.md 상세 설계 (PM 동작 지침)

sandoc 프로젝트 루트의 CLAUDE.md. Claude Code 진입 시 자동 로드.

```markdown
# CLAUDE.md — sandoc 프로젝트 지침

## 프로젝트 개요
sandoc은 정부 지원사업 사업계획서를 자동 작성하는 시스템입니다.
당신은 PM(프로젝트 매니저)입니다. 4명의 팀원(subagent)을 관리합니다.

## 진입 시 체크
1. config/settings.json 로드
2. profiles/ 에서 등록된 회사 프로필 확인
3. projects/ 스캔 → 활성 프로젝트 확인
   - context.md의 status 필드로 현재 Phase 판별
   - 진행 중인 프로젝트가 있으면 이어서 진행
4. 상태 보고: "현재 {N}개 프로젝트. {프로젝트명}이 Phase {N}에 있습니다."

## 명령어
- "새 사업: {이름}" → 새 프로젝트 생성
- "서류 넣었어" / "분석해" → Phase 1 시작
- "초안 써줘" → Phase 4 시작
- "수정해줘: {내용}" → Phase 5
- "출력해줘" / "최종본" → Phase 6
- "심사해봐" → 자가 심사
- "프로필 등록" → 프로필 온보딩
- "상태" → 현재 프로젝트 상태 보고
- "프로젝트 목록" → 전체 프로젝트 리스트

## 팀원 호출 규칙

### 📋 analyst 호출 시점
- docs/ 폴더에 새 파일이 있을 때
- 공고 분석이 필요할 때
- 자가 심사 요청 시
- 시장 데이터 수집 필요 시

### ✍️ writer 호출 시점
- 텍스트 초안 작성 시
- 섹션 수정 요청 시
- 전략 수립 시

### 🎨 visualist 호출 시점
- writer가 [VISUAL] 태그를 남긴 후
- 표/차트/다이어그램 수정 요청 시
- 출처 데이터 수집 필요 시

### 📐 docengine 호출 시점
- 최종 HWP 출력 시
- 양식 구조 확인이 필요할 때
- HWP ↔ HWPX 변환 시

## 사용자 대화 톤
- 전문적이되 친절하게
- 진행 상황을 단계별로 명확히 보고
- 선택지를 줄 때는 번호 매기기
- 긴 결과는 요약 먼저 → 상세는 파일 참조

## 금지 사항
- 수치 날조 금지 (출처 없는 데이터 사용 X)
- 사용자 확인 없이 Phase 건너뛰기 금지
- 한 번에 모든 Phase 실행 금지 (단계별 진행)
- 양식 서식 임의 변경 금지
```

---

## ⚠️ 에러 & 예외 처리

### 문서 처리 에러

```
에러 상황                          │ 대응
────────────────────────────────────┼──────────────────────────────
HWP 파싱 실패                      │ 1. HWP→HWPX 변환 시도
(암호화/깨진 파일)                   │ 2. 실패 시 사용자에게 HWPX 변환 요청
                                   │ 3. 한컴 온라인(hancom.com)으로 열기 안내
                                   │
양식 구조 인식 불가                  │ 1. 빈 칸/표가 없는 문서인지 확인
(섹션 구분 불가)                    │ 2. 사용자에게 "이 파일이 양식이 맞나요?" 확인
                                   │ 3. 수동으로 섹션 구조 입력 받기
                                   │
표 셀병합 복잡                      │ 1. 표 구조 시각화해서 사용자에게 보여주기
                                   │ 2. 셀 단위 삽입 시도 → 실패 시 텍스트만 삽입
                                   │ 3. 수동 입력 안내
                                   │
OCR 인식 실패                       │ 1. 다른 OCR 방식 시도 (vision → 텍스트)
(흐린 이미지/스캔 품질)              │ 2. 실패 시 사용자에게 수동 입력 요청
                                   │ 3. "사업자등록번호만이라도 입력해주세요"
                                   │
PDF 텍스트 추출 실패                 │ 1. 이미지형 PDF인지 확인
(이미지형 PDF)                      │ 2. OCR 모드로 전환
                                   │ 3. 페이지별 vision 처리
```

### 콘텐츠 에러

```
에러 상황                          │ 대응
────────────────────────────────────┼──────────────────────────────
서류 부족                          │ 1. 필수/선택 구분해서 안내
(양식 없음, 공고문 없음)             │   "공고문은 필수입니다. 양식은 공고문에서
                                   │    추론 가능하지만 정확도가 떨어집니다"
                                   │ 2. 공고 URL 받아서 직접 다운로드 시도
                                   │
심사기준 추출 실패                   │ 1. 공고문에 명시 안 된 경우
                                   │ 2. knowledge/에서 유사 공고 패턴 검색
                                   │ 3. 일반적인 배점 구조 제안 → 사용자 확인
                                   │
분량 초과/부족                      │ 1. 초과: 우선순위 낮은 내용 압축 제안
                                   │ 2. 부족: 보강 가능한 섹션 제안
                                   │ 3. 사용자에게 조정 방향 확인
                                   │
수치 불일치                         │ 1. 자동 감지 (표 합계 ≠ 총계 등)
                                   │ 2. 불일치 위치 명시
                                   │ 3. 어느 쪽이 맞는지 사용자 확인
                                   │
회사 정보 부족                      │ 1. 프로필 DB 확인
                                   │ 2. docs/에서 추출 시도
                                   │ 3. 필수 정보만 질문 (최소 질문 원칙)
```

### 시스템 에러

```
에러 상황                          │ 대응
────────────────────────────────────┼──────────────────────────────
hwpx-mcp 연결 실패                  │ 1. MCP 서버 상태 체크
                                   │ 2. 재시작 시도
                                   │ 3. 텍스트 기반 초안만 진행 (HWP 삽입은 나중에)
                                   │
컨텍스트 초과                       │ 1. 큰 문서는 섹션별로 나눠서 처리
                                   │ 2. context.md에 진행 상황 저장
                                   │ 3. 새 세션에서 context.md로 복구
                                   │
subagent 실패                      │ 1. 에러 내용 로깅
                                   │ 2. PM이 직접 해당 작업 수행
                                   │ 3. 사용자에게 지연 안내
```

---

## 🆕 프로필 온보딩 플로우

최초 사용 시 회사 프로필을 등록하는 과정.

```
트리거: "프로필 등록" 또는 첫 프로젝트 생성 시 프로필 없음 감지

Step 1: 입력 방식 선택
    "회사 프로필을 등록합니다. 어떤 방식으로 할까요?
     1) 사업자등록증 이미지/PDF 업로드 → 자동 추출
     2) 회사소개서 업로드 → 자동 추출
     3) 직접 입력"

Step 2-A: 자동 추출 (선택 1 또는 2)
    → docs/ 또는 profiles/ 에 파일 넣기 안내
    → OCR/파싱으로 기본 정보 추출
    → 추출 결과 보여주기
    → "맞나요? 수정할 부분 있나요?"

Step 2-B: 직접 입력 (선택 3)
    → 핵심 정보만 순차 질문 (최소 질문)
    질문 순서:
    1. 회사명
    2. 대표자명
    3. 사업자등록번호
    4. 업종 (업태/종목)
    5. 설립일
    6. 주소
    7. 주요 사업/서비스 (한 줄)
    
    선택 정보 (나중에 추가 가능):
    - 직원 수, 매출, 연혁, 인증/특허, 수행실적

Step 3: 프로필 저장
    → profiles/{회사명}.md 생성
    → "프로필 등록 완료! 이후 사업계획서 작성 시 자동으로 활용됩니다."

Step 4: 추가 정보 안내
    → "나중에 아래 정보를 추가하면 더 좋은 사업계획서를 만들 수 있어요:
       - 회사 연혁
       - 재무 현황 (최근 3년)
       - 보유 인증/특허
       - 기존 정부사업 수행 이력
       profiles/{회사명}.md 파일을 직접 편집하거나,
       '프로필 수정'이라고 말해주세요."
```

### 프로필 업데이트

```
트리거: "프로필 수정" / "회사 정보 업데이트"

→ 기존 프로필 보여주기
→ "어떤 부분을 수정/추가할까요?"
→ 수정 반영 → 저장
→ 기존 프로젝트의 context.md에는 영향 없음 (이미 작성된 건 그대로)
→ 새 프로젝트부터 업데이트된 프로필 적용
```

### 멀티 프로필

```
여러 회사의 사업계획서를 대행하는 경우:
- profiles/비아컴퍼니.md
- profiles/ABC스타트업.md
- profiles/XYZ테크.md

프로젝트 생성 시:
"어떤 회사로 작성할까요?
 1) 비아컴퍼니
 2) ABC스타트업
 3) 새 회사 등록"
```

---

## 📁 멀티 프로젝트 관리

### 프로젝트 상태 관리

각 프로젝트의 context.md에 상태 헤더:

```markdown
# context.md

## 상태
- **status**: active | paused | completed | archived
- **phase**: 0~6
- **profile**: 비아컴퍼니
- **created**: 2026-02-12
- **updated**: 2026-02-15
- **deadline**: 2026-03-01 (접수 마감)

## 파일 분류 결과
...
```

### 프로젝트 목록 뷰

```
> "프로젝트 목록"

📁 sandoc 프로젝트 현황
──────────────────────────────────
 #  사업명                상태    Phase  마감일
 1  2026-중기부-스마트공장  🟢진행   4/6   2026-03-01
 2  2026-과기부-AI-R&D     ⏸일시정지 2/6   2026-04-15
 3  2025-지자체-창업지원    ✅완료   6/6   -
──────────────────────────────────

"1번 이어서 해줘" → 해당 프로젝트 활성화
```

### 프로젝트 전환

```
트리거: "1번 프로젝트" / "{사업명} 이어서"

→ 해당 프로젝트의 context.md 로드
→ 현재 Phase 확인
→ "2026-중기부-스마트공장, Phase 4(초안 작성) 중입니다.
    마지막 작업: 섹션 3 초안 작성 완료.
    이어서 진행할까요?"
```

### 프로젝트 아카이브

```
트리거: 사업 선정/탈락 결과 입력

선정 시:
→ status: completed
→ knowledge/에 성공 패턴 저장
→ "축하합니다! 이 사업계획서의 패턴을 학습했습니다."

탈락 시:
→ status: completed (결과: 탈락)
→ 탈락 사유 입력 받기
→ knowledge/lessons.md에 교훈 저장
→ "다음에는 {탈락사유}를 보완하겠습니다."

아카이브:
→ status: archived
→ projects/{사업명}/ 폴더는 유지 (참고용)
```

### 마감일 관리

```
context.md의 deadline 필드 활용:

- D-30: "한 달 남았습니다. Phase 4까지 완료하는 것을 권장합니다."
- D-14: "2주 남았습니다. 초안 검토를 시작하세요."
- D-7: "일주일 남았습니다. 최종본 확정이 필요합니다."
- D-3: "3일 남았습니다! 제출 준비 체크리스트를 확인하세요."
- D-1: "내일 마감입니다. 최종 점검 중..."
- D-0: "오늘 마감입니다! 접수 방법: {URL}"
```

---

## 📝 버전 관리 시스템

### 초안 버전 추적

```
output/
├── drafts/
│   ├── v1/                       # 첫 번째 초안
│   │   ├── 01-사업개요.md
│   │   ├── 02-기업현황.md
│   │   └── ...
│   ├── v2/                       # 사용자 피드백 반영
│   │   ├── 01-사업개요.md
│   │   ├── 02-기업현황.md (수정됨)
│   │   └── ...
│   └── current/                  # 현재 최신 버전 (심볼릭 링크 or 복사)
│       ├── 01-사업개요.md
│       └── ...
├── visuals/
│   └── (버전별로 관리하지 않음 — 항상 최신)
├── 사업계획서.hwpx               # 최종본
├── 사업계획서_v1.hwpx            # 이전 출력본
└── review.md                     # 최신 자가 심사
```

### 변경 이력 (context.md에 기록)

```markdown
## 변경 이력

### v3 (2026-02-15)
- 섹션 2: 기업현황 → 수행실적 추가
- 섹션 5: 예산 인건비 항목 수정 (3명→4명)
- 비주얼: 매출추정 그래프 업데이트
- 트리거: 사용자 피드백 "인력 한 명 추가해줘"

### v2 (2026-02-14)
- 섹션 3: 기술 차별성 보강
- 섹션 6: 추진일정 구체화
- 트리거: 자가 심사 결과 기술성 점수 부족

### v1 (2026-02-13)
- 전체 초안 최초 생성
- 8개 섹션 완성
```

### 버전 비교

```
> "v1이랑 v2 차이 보여줘"

📊 v1 → v2 변경 사항
──────────────────────
 섹션           변경 내용
 01-사업개요     변경 없음
 02-기업현황     변경 없음
 03-기술내용     ✏️ 차별성 논거 추가 (+15줄)
 04-기술개발     변경 없음
 05-사업비       변경 없음
 06-추진일정     ✏️ 마일스톤 3개 추가
 07-기대효과     변경 없음
 08-기타         변경 없음
──────────────────────
 변경: 2개 섹션 | 추가: 23줄 | 삭제: 2줄
```

### 롤백

```
> "v1으로 돌아가줘" / "섹션 3만 v1으로"

→ 전체 롤백: current/ → v1/ 내용으로 교체
→ 부분 롤백: 특정 섹션만 이전 버전으로 교체
→ 롤백 사실을 변경 이력에 기록
```

---

## 🔄 피드백 학습 루프

### 작성 완료 후 학습 프로세스

```
사업계획서 제출 완료 후:
   │
   ├── 결과 입력 대기
   │   "선정/탈락 결과가 나오면 알려주세요"
   │
   ├── 선정 시:
   │   ├── 이 사업계획서의 패턴 분석
   │   │   ├── 어떤 표현이 효과적이었나
   │   │   ├── 어떤 구조가 좋았나
   │   │   ├── 시각 자료 활용도
   │   │   └── 심사기준별 대응 전략
   │   ├── knowledge/patterns/에 저장
   │   ├── knowledge/expressions/에 효과적 표현 추가
   │   └── knowledge/scoring/에 성공 전략 기록
   │
   ├── 탈락 시:
   │   ├── 탈락 사유 입력
   │   │   "심사 피드백이 있으면 공유해주세요"
   │   ├── 부족했던 부분 분석
   │   ├── knowledge/lessons.md에 교훈 기록
   │   ├── 해당 공고 유형의 패턴 업데이트
   │   └── 다음 작성 시 자동 반영
   │       "이전 탈락 사유: 기술 차별성 부족
   │        → 이번에는 섹션 3에서 특허/논문 근거를 강화합니다"
   │
   └── 학습 효과
       ├── 작성할수록 초안 품질 향상
       ├── 같은 유형 공고는 더 빠르게 작성
       ├── 심사위원 선호 패턴 축적
       └── 효과적인 표현/수치 활용법 학습
```

### knowledge/ 자동 업데이트 규칙

```
매 프로젝트 완료 시:
1. patterns/{공고유형}.md — 양식 구조, 배점 패턴 추가
2. expressions/ — 새로 사용한 효과적 표현 추가
3. scoring/ — 심사기준 대응 전략 업데이트
4. lessons.md — 이번 프로젝트의 교훈 추가

축적 데이터 활용:
- 새 프로젝트 시작 시 유사 공고 패턴 자동 로드
- 초안 작성 시 검증된 표현 우선 사용
- 자가 심사 시 과거 탈락 사유 자동 체크
```

---

## 🛡️ 데이터 보안 & 프라이버시

```
보안 원칙:
├── 회사 정보는 로컬에만 저장 (profiles/, projects/)
├── GitHub에 push하지 않음 (.gitignore)
│   ├── profiles/*.md
│   ├── projects/*/docs/
│   ├── projects/*/output/
│   └── config/settings.json (API 키 포함 시)
├── 사업자등록증 등 민감 서류는 처리 후 원본만 유지
├── 외부 API 전송 시 최소한의 정보만 (시장조사 키워드 등)
└── 삭제 요청 시 완전 삭제 (trash 아님)
```

### .gitignore

```
# 민감 데이터
profiles/*.md
!profiles/_template.md
projects/*/docs/
projects/*/output/
config/settings.json

# 시스템 파일
.DS_Store
*.bak
```

---

## 🎭 문체 & 페르소나 프리셋

사업계획서의 톤, 문체, 어필 전략을 프리셋으로 선택.
프로젝트 생성 시 또는 Phase 3(전략 수립) 시점에 선택.

```
> "새 사업: 2026 중기부 스마트공장"
> ...
> "문체를 선택해주세요:
>  1) 🏛️ 정석파  — 정부 사업계획서 교과서 스타일
>  2) 🔬 기술파  — 기술 깊이로 승부
>  3) 📊 데이터파 — 숫자와 근거로 압도
>  ...
>  또는 '추천'이라고 하면 공고 유형에 맞춰 추천합니다"
```

### 프리셋 목록

#### 1. 🏛️ 정석파 (The Classic)
```
컨셉: 정부 사업계획서의 교과서. 빈틈없는 정석 스타일.
적합: 중기부 일반 과제, 지자체 지원사업, 처음 지원하는 공고
문체:
  - 격식체 ("~을 추진할 계획임", "~에 기여하고자 함")
  - 논리적 흐름 (배경→필요성→목표→방법→기대효과)
  - 모든 항목 빠짐없이 작성
  - 안정적, 신뢰감
어필 전략:
  - 정부 정책 방향과의 정합성 강조
  - 기존 인프라/역량 기반 실현 가능성
  - 보수적 목표 설정 (달성 가능한 수치)
예시 톤: "본 사업은 정부의 디지털 전환 정책 기조에 부합하며,
         당사의 10년간 축적된 기술 역량을 바탕으로
         안정적인 사업 수행이 가능할 것으로 판단됨."
```

#### 2. 🔬 기술파 (The Engineer)
```
컨셉: 기술의 독창성과 깊이로 심사위원을 설득.
적합: 과기부 R&D, 기술개발 과제, 특허 기반 사업
문체:
  - 기술 용어 적극 사용 (단, 비전문가도 이해 가능하게 보조 설명)
  - 기존 기술 한계점 → 제안 기술의 차별점 구조
  - 기술 아키텍처, 알고리즘, 성능 수치 상세 서술
  - 특허/논문 인용
어필 전략:
  - 기존 기술 대비 차별성 (정량 비교표)
  - 원천 기술/핵심 특허 보유 강조
  - 기술 TRL(기술 성숙도) 단계 명시
  - 기술 확장성/파급효과
예시 톤: "기존 LSTM 기반 예측 모델의 한계(정확도 78.2%)를 극복하기 위해,
         당사는 Transformer 아키텍처를 활용한 독자적 예측 엔진(특허 제10-XXXX호)을
         개발하였으며, 실증 테스트에서 92.7%의 정확도를 달성하였음."
```

#### 3. 📊 데이터파 (The Analyst)
```
컨셉: 모든 주장에 수치와 출처를 달아 객관성으로 승부.
적합: 시장 진입형 사업, 사업화 과제, 투자 연계형
문체:
  - 매 문단 최소 1개 이상 수치 포함
  - 출처 빠짐없이 표기
  - 표와 차트 비중 높음 (텍스트:시각자료 = 6:4)
  - 비교/분석 프레임워크 활용 (SWOT, 5 Forces 등)
어필 전략:
  - TAM/SAM/SOM 시장 분석
  - 경쟁사 대비 정량 비교
  - ROI, 손익분기점 명확히 제시
  - 매출 추정의 근거 체인 (시장규모→점유율→단가→매출)
예시 톤: "국내 스마트팩토리 시장은 2025년 4.2조원에서 연평균 15.3% 성장하여
         2028년 6.5조원에 달할 전망임(출처: KIET, 2025).
         당사는 해당 시장의 SOM 0.5%인 325억원을 목표로 하며,
         이는 기존 고객사 12개사 확장 기반의 보수적 추정임."
```

#### 4. 🚀 비전파 (The Visionary)
```
컨셉: 큰 그림과 성장 스토리로 기대감을 자극.
적합: 예비창업패키지, 초기창업, 액셀러레이터, 혁신형
문체:
  - 문제 정의 → 비전 제시 → 실행 전략 스토리라인
  - 미래 시장 변화 트렌드 활용
  - "왜 지금, 왜 우리" 내러티브
  - 약간의 열정과 확신 (단, 과장 금지)
어필 전략:
  - 해결하려는 문제의 크기와 시급성
  - 타이밍의 적절성 (규제 변화, 기술 성숙, 시장 수요)
  - 팀의 도메인 전문성
  - 단계별 성장 로드맵 (3~5년)
예시 톤: "2026년, 국내 중소 제조업의 67%는 여전히 수기로 생산 데이터를 관리하고 있음.
         이는 연간 평균 2.3억원의 비효율을 발생시키며,
         이 문제를 해결할 수 있는 팀과 기술이 바로 지금 준비되어 있음."
```

#### 5. 🤝 실적파 (The Proven)
```
컨셉: "우리는 이미 해봤고, 잘 했다"는 실적 기반 신뢰.
적합: 재도전/후속 과제, 성장기 기업, 수행실적이 풍부한 경우
문체:
  - 과거 수행 실적 → 현재 역량 → 미래 계획 연결
  - 구체적 사례/케이스 스터디 중심
  - 고객사 만족도, 매출 성장률 등 성과 지표
  - "검증된" 느낌
어필 전략:
  - 유사 사업 수행 실적 (금액, 기간, 성과)
  - 기존 고객사/파트너 네트워크
  - 수상/인증 이력
  - 핵심 인력의 관련 경력
예시 톤: "당사는 2023년 중기부 스마트공장 구축사업을 성공적으로 수행하여
         참여 기업 15개사의 생산성을 평균 23.7% 향상시킨 실적이 있음.
         본 사업은 해당 경험을 확장하여 추가 30개사에 적용하는 것을 목표로 함."
```

#### 6. 💡 혁신파 (The Disruptor)
```
컨셉: 기존 방식을 뒤엎는 파괴적 혁신을 어필.
적합: 신기술 기반, 플랫폼/SaaS, 규제 샌드박스, 혁신 바우처
문체:
  - AS-IS(현재) → TO-BE(미래) 대비 구조
  - 기존 방식의 비효율/한계를 날카롭게 지적
  - 제안 솔루션의 게임체인저적 효과 부각
  - 사용 전/후 비교 (정량적)
어필 전략:
  - 기존 시장의 Pain Point 명확화
  - Before/After 극적 대비
  - 특허/기술 장벽에 의한 모방 불가성
  - 빠른 시장 확산 전략 (네트워크 효과, 바이럴)
예시 톤: "현재 제조업 품질검사는 육안에 의존하며 불량률 3.2%를 감수하고 있음.
         당사의 AI 비전 검사 시스템은 이를 0.1%로 낮추며,
         검사 시간을 기존 대비 1/50로 단축함.
         이는 기존 방식의 근본적 전환을 의미함."
```

#### 7. 🌱 사회가치파 (The Impact)
```
컨셉: 사회적 가치와 공익성을 전면에 내세움.
적합: 사회적기업, ESG 관련, 고용창출형, 지역상생, 소셜벤처
문체:
  - 사회 문제 인식 → 솔루션 → 사회적 임팩트 구조
  - 고용 창출, 환경 보호, 지역 경제 기여 수치화
  - 수혜자/이해관계자 관점 서술
  - 지속가능성 강조
어필 전략:
  - 사회적 문제 해결 임팩트 정량화
  - 직·간접 고용 창출 효과
  - 지역 경제 파급 효과
  - ESG 경영 연계
  - UN SDGs 연결
예시 톤: "본 사업을 통해 농촌 지역 고령 농업인 500명에게
         스마트팜 기술 교육을 제공하고, 생산성 30% 향상으로
         연간 소득 500만원 증가 효과를 기대함.
         이는 농촌 인구 유출 방지와 지역 경제 활성화에 기여할 것임."
```

#### 8. 🏭 제조파 (The Builder)
```
컨셉: 생산/제조/공정에 특화된 실무 중심 서술.
적합: 스마트공장, 설비투자, 제조혁신, 공정개선
문체:
  - 현재 공정 → 개선 공정 비교 (수율, 불량률, 리드타임)
  - 설비 스펙, 공정 플로우차트 상세
  - 생산량/품질/비용 개선 효과 정량화
  - 현장 실무 용어 사용
어필 전략:
  - 공정 개선 전/후 KPI 비교
  - 설비 투자 대비 회수 기간
  - 생산 능력(CAPA) 증대 효과
  - 품질 인증 연계 (ISO, KS 등)
예시 톤: "현재 CNC 가공 공정의 사이클타임은 45분/개이며, 불량률은 2.8%임.
         5축 복합가공기 도입 시 사이클타임 28분(-37.8%), 불량률 0.5%(-82.1%)로
         개선되며, 월 생산량 1,200개→1,900개(+58.3%)로 증대됨.
         설비 투자비 3.2억원은 18개월 내 회수 가능함."
```

#### 9. 📱 플랫폼파 (The Scaler)
```
컨셉: 플랫폼/SaaS/앱 기반 사업의 성장 모델 어필.
적합: 플랫폼 사업, 데이터 기반, 구독형 서비스, O2O
문체:
  - 사용자 여정(User Journey) 중심 서술
  - 핵심 지표(KPI) 기반: MAU, 전환율, LTV, CAC
  - 스케일업 전략 (지역→전국→해외)
  - 데이터 플라이휠/네트워크 효과 설명
어필 전략:
  - 사용자 Pain Point → 솔루션 시연 시나리오
  - 핵심 지표 목표와 달성 전략
  - 유닛 이코노믹스 (LTV > CAC × 3)
  - 데이터 축적에 따른 경쟁 우위
  - 확장 로드맵 (국내 → 글로벌)
예시 톤: "현재 베타 서비스 MAU 3,200명, 유료 전환율 8.5%를 달성하였으며,
         고객당 획득비용(CAC) 12,000원 대비 생애가치(LTV) 180,000원으로
         LTV/CAC 비율 15x의 건전한 유닛 이코노믹스를 확보하고 있음.
         본 사업을 통해 MAU 50,000명, 전환율 12%를 목표로 함."
```

#### 10. 🌏 글로벌파 (The Global)
```
컨셉: 해외 진출/수출 관점의 글로벌 사업 어필.
적합: 수출 바우처, 해외 진출 지원, 글로벌 스타트업, K-브랜드
문체:
  - 글로벌 시장 규모와 기회 강조
  - 국내 성과 → 해외 확장 로직
  - 타겟 국가/지역별 전략
  - 현지화(Localization) 계획
어필 전략:
  - 글로벌 TAM과 진출 국가 SAM
  - 해외 경쟁사 대비 가격/기술 경쟁력
  - 현지 파트너/채널 확보 현황
  - 인증/규격 대응 (CE, UL, FDA 등)
  - 기존 해외 매출/수출 실적
예시 톤: "글로벌 스마트팩토리 솔루션 시장은 2028년 USD 89.4B에 달할 전망이며(출처: MarketsandMarkets),
         당사는 동남아 시장을 1차 타겟으로 설정하였음.
         베트남 현지법인 설립 완료(2025.06) 및 파일럿 고객 3사 확보를 기반으로
         2027년까지 해외 매출 비중 30%를 목표로 함."
```

### 프리셋 선택 & 혼합

```
단일 선택:
> "문체: 기술파"
→ 전체 문서를 기술파 톤으로 작성

혼합 선택:
> "문체: 기술파 + 데이터파"
→ 기술 섹션은 기술파, 시장/재무 섹션은 데이터파

섹션별 지정:
> "섹션 3,4는 기술파, 섹션 5,6은 데이터파, 나머지는 정석파"
→ 섹션별 다른 톤 적용

자동 추천:
> "추천"
→ 공고 유형 + 회사 특성 분석 → 최적 프리셋 추천
   예: "과기부 R&D 과제 + 특허 보유 기업 → 기술파 + 실적파 추천"
```

### 공고 유형별 추천 매핑

```
공고 유형              │ 추천 프리셋         │ 이유
───────────────────────┼────────────────────┼──────────────────
예비창업패키지          │ 🚀비전 + 📊데이터   │ 성장 스토리 + 시장 검증
초기창업패키지          │ 🚀비전 + 🤝실적     │ 초기 성과 + 확장 비전
스마트공장 구축         │ 🏭제조 + 💡혁신     │ 공정 개선 + 혁신 효과
R&D 과제 (과기부)      │ 🔬기술 + 📊데이터   │ 기술 깊이 + 객관성
사회적기업 지원         │ 🌱사회가치 + 🏛️정석  │ 임팩트 + 안정감
수출 바우처             │ 🌏글로벌 + 🤝실적   │ 해외 전략 + 기존 실적
지역 특화 사업          │ 🌱사회가치 + 🏭제조  │ 지역 기여 + 실무 역량
플랫폼/서비스형         │ 📱플랫폼 + 💡혁신   │ 스케일 + 차별화
혁신 바우처             │ 💡혁신 + 🔬기술     │ 혁신성 + 기술력
일반 지원사업           │ 🏛️정석 + 🤝실적     │ 안정감 + 신뢰성
```

### config에 프리셋 저장

```json
// config/settings.json
{
  "presets": {
    "default": "classic",
    "favorites": ["classic", "engineer", "analyst"],
    "customPresets": {
      "우리회사스타일": {
        "base": "engineer",
        "mix": ["analyst"],
        "overrides": {
          "tone": "살짝 친근하게",
          "emphasisOn": ["특허", "수행실적"],
          "avoidWords": ["획기적", "혁신적"]
        }
      }
    }
  }
}
```

### 프리셋 파일 구조

```
knowledge/presets/
├── classic.md          # 🏛️ 정석파
├── engineer.md         # 🔬 기술파
├── analyst.md          # 📊 데이터파
├── visionary.md        # 🚀 비전파
├── proven.md           # 🤝 실적파
├── disruptor.md        # 💡 혁신파
├── impact.md           # 🌱 사회가치파
├── builder.md          # 🏭 제조파
├── scaler.md           # 📱 플랫폼파
├── global.md           # 🌏 글로벌파
└── custom/             # 사용자 커스텀 프리셋
    └── 우리회사스타일.md
```

각 프리셋 파일에 포함되는 내용:
- 문체 규칙 (어미, 톤, 금지어, 추천어)
- 섹션별 어필 전략
- 예시 문장 10개 이상
- 자주 쓰는 표현 리스트
- 시각 자료 활용 가이드 (해당 프리셋에 맞는)

---

## 확장 로드맵

**v1: MVP** — 기본 플로우 동작 (서류 분석 → 초안 → HWP 출력)
**v2: 시장조사 연동** — Tavily/검색 API로 시장 데이터 자동 수집
**v3: 지식 축적** — 작성할수록 품질 향상, 패턴 학습
**v4: 재무 자동화** — 매출추정, 예산서, 손익분기점 자동 생성
**v5: 멀티 포맷** — HWPX + DOCX + PDF 출력 지원
**v6: 공고 모니터링** — 관심 공고 자동 탐지 + 알림
**v7: 협업** — 여러 사람이 섹션별 분담 작성
