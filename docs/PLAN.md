# sandoc — 사업계획서 자동 작성 시스템

## 비전
**"서류 넣고, 대화하고, 완성본 받는다"**

공고 서류를 폴더에 넣으면 AI가 분석하고, 대화로 부족한 정보를 채우고, 양식 그대로 완성된 사업계획서를 출력하는 시스템.

---

## 시스템 아키텍처

```
┌─────────────────────────────────────────────────┐
│                   sandoc 시스템                   │
│                                                   │
│  ┌──────────┐   ┌──────────┐   ┌──────────────┐  │
│  │ 문서엔진  │   │  AI 코어  │   │  지식 저장소  │  │
│  │(hwpx-mcp)│◄─►│(Claude)  │◄─►│(knowledge/) │  │
│  └──────────┘   └────┬─────┘   └──────────────┘  │
│                      │                            │
│  ┌──────────┐   ┌────┴─────┐   ┌──────────────┐  │
│  │ 문서분류기│   │ 프로세스  │   │  프로필 DB   │  │
│  │(자동판별)│◄─►│ 컨트롤러 │◄─►│(profiles/)  │  │
│  └──────────┘   └──────────┘   └──────────────┘  │
└─────────────────────────────────────────────────┘
```

### 핵심 모듈

**1. 문서엔진 (hwpx-mcp-server)**
- HWP/HWPX 읽기 → 텍스트 + 구조 추출
- HWP → HWPX 자동 변환
- HWPX 쓰기 → 양식 유지하며 내용 삽입
- 표 셀 단위 조작

**2. 문서분류기**
- docs/ 폴더의 모든 파일을 스캔
- 파일 내용 기반 역할 자동 판별
- 분류 기준:
  - 공고문/모집요강: "심사기준", "지원자격", "접수기간" 등 키워드
  - 양식: 빈 칸, "작성요령", 반복 구조
  - 사업자등록증: "사업자등록번호", "대표자" 등
  - 회사소개서: "연혁", "조직도", "주요사업"
  - 재무제표: "매출액", "영업이익", "대차대조표"
  - 기타 참고자료: 위에 해당 안 되는 것

**3. AI 코어 (Claude Code)**
- 단계별 프로세스 진행
- 심사기준 기반 콘텐츠 생성
- 정부 사업계획서 문체 적용
- 사용자와 대화형 정보 수집

**4. 지식 저장소 (knowledge/)**
- 공고 유형별 패턴 축적
- 심사기준 패턴 학습
- 자주 쓰는 표현/문구 DB
- 완성된 사업계획서에서 피드백 학습

**5. 프로필 DB (profiles/)**
- 회사별 기본 정보 저장
- 한번 입력 → 모든 사업에 재사용
- 사업자등록증에서 자동 추출 가능

---

## 📂 폴더 구조

```
~/001_Projects/H1-sandoc/
├── CLAUDE.md                    # Claude Code 프로젝트 지침
├── config/
│   └── settings.json            # 시스템 설정
├── profiles/                    # 회사 프로필 DB
│   ├── {회사명}.md              # 회사별 프로필
│   └── _template.md             # 프로필 템플릿
├── projects/                    # 사업별 작업 폴더
│   └── {YYYY-사업명}/
│       ├── docs/                # 서류 통째로 넣는 곳
│       ├── output/              # 생성 결과물
│       │   ├── 사업계획서.hwpx  # 최종본
│       │   ├── drafts/          # 섹션별 초안
│       │   └── review.md        # 자가 심사 리포트
│       └── context.md           # 자동 생성 (분석+진행상황)
├── knowledge/                   # 축적 지식
│   ├── patterns/                # 공고 유형별 패턴
│   ├── expressions/             # 자주 쓰는 표현 DB
│   ├── scoring/                 # 심사기준 분석 패턴
│   └── lessons.md               # 작성 후 교훈/피드백
└── docs/
    └── PLAN.md                  # 이 파일
```

---

## 🔄 프로세스 설계

### Phase 0: 프로젝트 생성
```
트리거: "새 사업: {사업명}"
   │
   ├── projects/{YYYY-사업명}/ 폴더 생성
   ├── docs/, output/, output/drafts/ 하위 폴더 생성
   └── "docs/ 폴더에 관련 서류를 넣어주세요" 안내
       - 공고문, 모집요강, 양식
       - 사업자등록증, 회사소개서 (없으면 프로필에서)
       - 참고할 자료 아무거나
```

### Phase 1: 서류 스캔 & 분류
```
트리거: "서류 넣었어" / "분석해줘"
   │
   ├── docs/ 전체 파일 스캔
   │   ├── 파일 형식 판별 (HWP/PDF/이미지/DOCX/엑셀)
   │   ├── 각 파일 내용 추출
   │   │   ├── HWP/HWPX → hwpx-mcp read_text
   │   │   ├── PDF → 텍스트 추출 / OCR
   │   │   ├── 이미지 → vision OCR  
   │   │   └── DOCX/기타 → 텍스트 추출
   │   └── 역할 자동 분류 (공고문/양식/증빙/참고)
   │
   ├── 분류 결과 → context.md에 저장
   │   {
   │     "files": [
   │       { "name": "...", "type": "공고문", "summary": "..." },
   │       { "name": "...", "type": "양식", "sections": [...] },
   │       ...
   │     ]
   │   }
   │
   ├── 분류 결과 사용자에게 보고
   │   "📋 공고문: 2026년도_중소기업_스마트공장_공고.hwp
   │    📝 양식: 사업계획서_양식.hwp (8개 섹션)
   │    🏢 사업자등록증: scan.jpg
   │    📎 참고: 작년_실적보고서.pdf"
   │
   └── 분류 틀리면 사용자가 교정 가능
       "공고문으로 분류된 건 실은 참고자료야" → 재분류
```

### Phase 2: 공고 심층 분석
```
자동 진행:
   │
   ├── 공고문/모집요강에서 추출:
   │   ├── 사업 개요 (목적, 규모, 기간)
   │   ├── 지원 자격 요건
   │   ├── 지원 제외 대상
   │   ├── 지원 금액/비율
   │   ├── 심사 기준 & 배점표
   │   │   예: 기술성 30점, 사업성 25점, 대표역량 20점...
   │   ├── 필수 제출서류 목록
   │   ├── 접수 기간 & 방법
   │   └── 주의사항/특이사항
   │
   ├── 양식에서 추출:
   │   ├── 전체 섹션 구조
   │   │   예: 1.사업개요, 2.기업현황, 3.기술개발 내용...
   │   ├── 각 섹션의 하위 항목
   │   ├── 표 구조 (행/열/셀병합)
   │   ├── 글자수/페이지 제한 (있으면)
   │   └── 작성 가이드/주의사항 (양식에 포함된 경우)
   │
   ├── 심사기준 ↔ 양식 섹션 매핑
   │   "기술성 30점 → 섹션 3,4에서 어필"
   │   "사업성 25점 → 섹션 5,6에서 어필"
   │
   ├── knowledge/에서 유사 공고 패턴 검색
   │   이전에 작성한 비슷한 공고 경험 활용
   │
   └── 분석 결과 보고 + context.md 업데이트
```

### Phase 3: 정보 수집 & 전략 수립
```
   ├── 프로필 DB에서 회사 정보 로드
   │   profiles/{회사명}.md → 기본정보, 연혁, 재무 등
   │
   ├── docs/의 참고자료에서 추가 정보 추출
   │   회사소개서, 실적보고서, 인증서 등
   │
   ├── 부족한 정보만 사용자에게 질문
   │   ✅ 이미 있는 정보는 묻지 않음
   │   ❓ "이 사업의 핵심 기술/아이디어는?"
   │   ❓ "기존에 관련 경험이나 실적이 있나요?"
   │   ❓ "희망 사업비 규모는?"
   │   ❓ "사업 완료 후 기대 성과는?"
   │
   ├── 작성 전략 수립
   │   ├── 심사기준별 어필 포인트 설정
   │   ├── 강점 부각 / 약점 보완 전략
   │   ├── 차별화 포인트 설정
   │   └── 섹션별 분량 배분
   │
   └── 전략 보고 → 사용자 확인
       "이런 방향으로 작성하려 합니다:
        - 기술성: OO 기술의 독창성 강조
        - 사업성: 기존 고객사 실적 활용
        OK?"
```

### Phase 4: 초안 작성
```
   ├── 섹션별 순차 작성
   │   ├── 각 섹션을 output/drafts/{섹션번호}-{섹션명}.md로 저장
   │   ├── 심사기준 배점 높은 섹션부터 작성
   │   ├── 정부 사업계획서 문체 적용
   │   │   - 객관적, 구체적, 수치 기반
   │   │   - "~할 것이다" → "~할 계획이며, 이를 통해 ~효과 기대"
   │   │   - 도표/표 적극 활용
   │   └── 각 섹션 작성 시 심사기준 체크
   │
   ├── 표/차트 데이터 생성
   │   ├── 추진일정표 (간트차트 형태)
   │   ├── 소요예산 내역서
   │   ├── 인력투입 계획
   │   └── 기대효과 정량화
   │
   └── 초안 전체 요약 보고
       "8개 섹션 초안 작성 완료.
        output/drafts/ 에서 확인하세요.
        특히 검토 필요: 섹션3(기술내용), 섹션6(예산)"
```

### Phase 5: 리뷰 & 수정 루프
```
   ├── 사용자 피드백 수집
   │   "섹션 2 좀 더 구체적으로"
   │   "예산 항목에 인건비 추가해줘"
   │   "전체적으로 톤이 너무 딱딱해"
   │
   ├── 수정 반영
   │   ├── 해당 섹션 수정 → drafts/ 업데이트
   │   ├── 연관 섹션 일관성 체크
   │   │   (예: 예산 변경 → 사업비 총괄표도 수정)
   │   └── 수정 이력 context.md에 기록
   │
   ├── 자가 심사 (사용자 요청 시)
   │   ├── 심사기준별 예상 점수 부여
   │   ├── 부족한 부분 지적
   │   ├── 개선 제안
   │   └── output/review.md에 저장
   │
   └── 반복 (사용자가 OK할 때까지)
```

### Phase 6: 최종 출력
```
   ├── 최종 확인
   │   ├── 양식 섹션 누락 체크
   │   ├── 필수 항목 빠진 거 없는지
   │   ├── 글자수/페이지 제한 확인
   │   └── 오탈자/문법 체크
   │
   ├── HWP 양식에 삽입
   │   ├── 원본 양식 HWPX 백업
   │   ├── hwpx-mcp로 각 섹션 내용 삽입
   │   ├── 표 셀에 데이터 채우기
   │   ├── 서식(폰트, 크기, 정렬) 유지
   │   └── output/사업계획서.hwpx 저장
   │
   ├── 최종 리포트
   │   ├── 자가 심사 점수
   │   ├── 보완 추천 사항
   │   └── 제출 전 체크리스트
   │
   └── 지식 축적
       ├── 이 공고의 패턴 → knowledge/patterns/에 저장
       ├── 효과적이었던 표현 → knowledge/expressions/에 저장
       └── 교훈 → knowledge/lessons.md에 추가
```

---

## 🔁 지식 축적 시스템

```
┌─────────────┐    ┌──────────────┐    ┌─────────────┐
│ 사업계획서   │    │              │    │ 다음 사업    │
│ 작성 완료    │───►│ 패턴 추출    │───►│ 계획서에     │
│              │    │ & 저장       │    │ 자동 활용    │
└─────────────┘    └──────────────┘    └─────────────┘

축적되는 지식:
├── 공고 유형별 양식 구조 패턴
│   "중기부는 보통 8섹션, 기술성/사업성/역량 배점"
├── 심사위원이 좋아하는 표현
│   "정량적 목표: 매출 30% 증가 → 구체적 수치"
├── 자주 빠뜨리는 항목
│   "추진일정에 마일스톤 빠짐"
├── 예산 작성 패턴
│   "인건비 비율 보통 40-50%"
└── 실패/성공 피드백
    "지난번 탈락 사유: 기술 차별성 부족"
```

### knowledge/ 구조
```
knowledge/
├── patterns/
│   ├── 중기부-스마트공장.md      # 공고 유형별 패턴
│   ├── 과기부-R&D.md
│   └── 지자체-창업지원.md
├── expressions/
│   ├── 기술성.md                 # "본 기술은 기존 대비..."
│   ├── 사업성.md                 # "시장 규모는 연평균..."
│   └── 공통.md                   # 자주 쓰는 문구
├── scoring/
│   ├── 심사기준-매핑.md          # 기준↔섹션 매핑 패턴
│   └── 고득점-전략.md            # 항목별 어필 포인트
└── lessons.md                    # 작성 후 교훈
```

---

## 🛡️ 품질 관리 체계

### 자가 심사 시스템
```
심사기준표 (공고에서 추출)
├── 기술성 (30점)
│   ├── 기술의 독창성/차별성  [?/10]
│   ├── 기술적 실현 가능성    [?/10]
│   └── 기술의 파급효과       [?/10]
├── 사업성 (25점)
│   ├── 시장 분석의 적절성    [?/10]
│   ├── 사업화 전략           [?/10]
│   └── 매출 계획 타당성      [?/5]
├── ...
└── 총점: ?/100
    ├── 80점 이상 → "제출 추천"
    ├── 60-80점 → "보완 후 제출"
    └── 60점 미만 → "재작성 권장"
```

### 일관성 체크
- 사업비 총액 = 각 항목 합계
- 인력 투입 = 조직도와 일치
- 추진일정 = 사업기간 내
- 기대효과 수치 = 현황 대비 합리적
- 전체 문서 내 회사명/대표자명 통일

---

## ⚙️ 시스템 설정

### config/settings.json
```json
{
  "defaultProfile": null,
  "documentEngine": {
    "type": "hwpx-mcp-server",
    "config": {
      "pagingLimit": 500,
      "autoBackup": true,
      "hardening": true
    }
  },
  "writing": {
    "style": "formal-government",
    "maxDraftIterations": 10,
    "autoSelfReview": true
  },
  "output": {
    "format": ["hwpx"],
    "backupOriginal": true,
    "generateReview": true
  }
}
```

### CLAUDE.md (Claude Code 동작 지침)
```
프로젝트 진입 시:
1. config/settings.json 로드
2. 활성 프로젝트 확인 (projects/ 중 context.md의 status)
3. 해당 프로젝트의 현재 Phase 이어서 진행

규칙:
- 한 Phase 완료 시 반드시 사용자 확인 받기
- 모든 진행 상황 context.md에 실시간 기록
- 추측하지 말고 서류에 있는 내용 기반으로 작성
- 정량적 수치는 반드시 출처 표기 (어떤 서류에서 가져왔는지)
- 없는 수치 날조 금지 → 사용자에게 확인 요청
```

---

## 📋 프로필 템플릿

### profiles/_template.md
```markdown
# 회사 프로필

## 기본 정보
- 회사명:
- 대표자:
- 사업자등록번호:
- 법인등록번호:
- 설립일:
- 업종(업태/종목):
- 주소:
- 연락처:
- 이메일:
- 홈페이지:

## 회사 소개
(회사 비전, 미션, 핵심 역량)

## 주요 사업/제품/서비스
- 

## 연혁
| 연도 | 내용 |
|------|------|
| | |

## 조직 & 인력
- 총 직원 수:
- 연구인력:
- 조직도: (설명 또는 파일 첨부)

## 재무 현황
| 연도 | 매출액 | 영업이익 | 당기순이익 |
|------|--------|----------|------------|
| | | | |

## 보유 인증/특허/지적재산
- 

## 수상/인정
-

## 기존 정부사업 수행 이력
| 사업명 | 주관기관 | 기간 | 결과 |
|--------|----------|------|------|
| | | | |

## 주요 거래처/고객사
-

## 기타 특이사항
-
```

---

## 확장 로드맵

**v1: MVP** — 기본 플로우 동작 (서류 분석 → 초안 → HWP 출력)
**v2: 지식 축적** — 작성할수록 품질 향상, 패턴 학습
**v3: 멀티 포맷** — HWPX + DOCX + PDF 출력 지원
**v4: 템플릿 라이브러리** — 공고 유형별 사전 템플릿 제공
**v5: 협업** — 여러 사람이 섹션별 분담 작성
