# 🏗️ 사업계획서 자동 작성 플로우 기획

## 개요
한글(HWP/HWPX) 공고 양식을 읽고, 사업자 정보를 입력받아, 양식에 맞게 사업계획서를 자동 작성하는 AI 워크플로우

## 선택 도구: hwpx-mcp-server
- **repo**: https://github.com/airmang/hwpx-mcp-server
- **이유**: MCP 표준 지원, HWP/HWPX 읽기+쓰기 모두 가능, Claude/OpenCode와 바로 연동
- **설치**: `uvx hwpx-mcp-server` (uv만 있으면 됨)
- HWP → HWPX 자동 변환 기능 내장

---

## 플로우 설계

### 📥 INPUT (사용자 제공)
1. **공고 파일** (HWP/HWPX) — 정부지원사업 공고문 + 사업계획서 양식
2. **사업자등록증** (이미지/PDF) — OCR로 자동 추출
3. **회사 정보** — 텍스트 또는 문서로 제공
   - 회사 소개, 주요 사업 내용
   - 대표자 정보, 연혁
   - 매출/재무 정보 (선택)
4. **사업 아이디어/내용** — 간단한 설명

### 🔄 PROCESS (자동화 단계)

```
Step 1: 문서 파싱 (hwpx-mcp-server)
├── 공고문 HWP 읽기 → 텍스트 추출
├── 양식 HWP 읽기 → 구조 분석 (섹션, 표, 필드 파악)
└── 사업자등록증 → OCR (이미지면 vision, PDF면 텍스트 추출)

Step 2: 양식 분석 (AI)
├── 양식의 각 섹션 식별
│   예: 1.사업개요, 2.추진배경, 3.사업내용, 4.추진일정, 5.소요예산...
├── 각 섹션에 필요한 정보 매핑
├── 공고문에서 심사 기준/배점 추출
└── 글자수 제한, 페이지 제한 파악

Step 3: 콘텐츠 생성 (AI)
├── 사업자 정보 + 사업 아이디어를 각 섹션에 맞게 작성
├── 공고 심사 기준에 맞춰 강조점 배치
├── 정부 사업계획서 문체/톤 적용
└── 표/차트 데이터 생성

Step 4: 문서 작성 (hwpx-mcp-server)
├── 원본 양식 HWPX 복사 (백업)
├── 각 필드에 생성된 콘텐츠 삽입
├── 표 셀에 데이터 채우기
├── 서식 유지하면서 텍스트 교체
└── 최종 HWPX 저장

Step 5: 검증 (AI + 사람)
├── 양식 누락 항목 체크
├── 글자수/페이지 제한 확인
├── 심사 기준 대비 자가 평가
└── 사용자 리뷰 → 수정 반복
```

### 📤 OUTPUT
- **완성된 사업계획서** (HWPX 파일) — 원본 양식 그대로 유지
- **자가 심사 리포트** — 심사 기준별 점수 예측
- **수정 제안** — 보완하면 좋을 부분

---

## MCP 설정 (OpenCode용)

```json
{
  "mcpServers": {
    "hwpx": {
      "command": "uvx",
      "args": ["hwpx-mcp-server"],
      "env": {
        "HWPX_MCP_PAGING_PARA_LIMIT": "500",
        "HWPX_MCP_AUTOBACKUP": "1",
        "HWPX_MCP_HARDENING": "1"
      }
    }
  }
}
```

## 실행 시나리오

```
건산님: "이 공고에 맞춰서 사업계획서 써줘" + HWP파일 2개 + 사업자등록증

molt:
1. hwpx-mcp로 공고문 읽기 → 핵심 요건 정리
2. hwpx-mcp로 양식 읽기 → 섹션별 구조 파악
3. 사업자등록증 OCR → 회사 기본정보 추출
4. "사업 내용 간단히 설명해주세요" (추가 질문)
5. AI가 각 섹션 초안 작성
6. hwpx-mcp로 양식에 내용 삽입
7. 완성본 HWPX 전달 + 자가 심사 리포트
```

---

## 구현 우선순위

1. **Phase 1**: hwpx-mcp-server 설치 + OpenCode MCP에 추가
2. **Phase 2**: HWP 읽기 → 구조 분석 테스트
3. **Phase 3**: 사업계획서 작성 프롬프트 최적화
4. **Phase 4**: 양식에 삽입 + 출력 테스트
5. **Phase 5**: 반복 수정 워크플로우 완성

## 필요 사항
- [ ] uv 설치 확인
- [ ] hwpx-mcp-server 테스트
- [ ] 샘플 공고 HWP 파일로 테스트
- [ ] 사업자등록증 OCR 테스트
